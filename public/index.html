<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ULTIMATEFUTSERVICE CHAT</title>

  <style>
    :root {
      --primary:#00ffea;
      --bg-dark:#0a0f1f;
      --bg-light:#1a2238;
    }

    body{
      font-family:Arial,sans-serif;
      background:linear-gradient(145deg,var(--bg-dark),var(--bg-light));
      color:#fff;
      display:flex;
      flex-direction:column;
      align-items:center;
      min-height:100vh;
      margin:0;
      padding:1rem;
    }

    h2{
      color:var(--primary);
      margin-bottom:.3rem;
      font-size:2.4rem;
      text-align:center;
    }

    /* ðŸ”¢ CONTADOR */
    #chatCounter{
      display:none;
      font-size:2rem;
      font-weight:bold;
      color:#fff;
      margin-bottom:1rem;
      text-align:center;
    }

    #topButtons{
      display:flex;
      gap:8px;
      margin-bottom:1rem;
      justify-content:center;
    }

    #exitBtn,#clearBtn{
      background:#ff4444;
      color:white;
      font-weight:bold;
      border:none;
      padding:10px 16px;
      border-radius:8px;
      cursor:pointer;
    }

    #clearBtn{
      background:#ffaa00;
      color:#000;
      display:none;
    }

    #loginForm{
      background:rgba(0,0,0,.6);
      padding:2rem;
      border-radius:15px;
      width:100%;
      max-width:400px;
      display:flex;
      flex-direction:column;
      gap:1rem;
    }

    input,select,button{
      padding:12px;
      font-size:1rem;
      border-radius:8px;
      border:none;
      outline:none;
    }

    input,select{
      background:rgba(255,255,255,.1);
      color:white;
    }

    button{
      background:var(--primary);
      color:#000;
      font-weight:bold;
      cursor:pointer;
    }

    #chat{
      list-style:none;
      padding:1rem;
      margin:1rem auto;
      background:rgba(0,0,0,.6);
      border-radius:15px;
      width:100%;
      max-width:700px;
      display:none;
      flex-direction:column;
      gap:10px;
      overflow-y:auto;
    }

    #chat li{
      padding:10px;
      border-radius:12px;
      max-width:80%;
      word-wrap:break-word;
    }

    .client{background:#00ffea;color:#000;align-self:flex-start}
    .player{background:#fff;color:#000;align-self:flex-end}
    .admin{background:#ffcc00;color:#000;align-self:flex-end}

    .time{
      font-size:.8em;
      opacity:.7;
      margin-top:4px;
    }

    #chatForm{
      display:none;
      width:100%;
      max-width:700px;
      gap:8px;
    }

    #msg{
      flex:1;
      background:rgba(255,255,255,.1);
      color:white;
    }

    @media(max-width:768px){
      h2{font-size:2rem}
      #chatCounter{font-size:1.6rem}
    }
  </style>
</head>

<body>

  <h2>ðŸ’¬ ULTIMATEFUTSERVICE Chat</h2>
  <div id="chatCounter">Messages: 0</div>

  <div id="topButtons" style="display:none;">
    <button id="exitBtn">Exit Chat</button>
    <button id="clearBtn">Clear Chat</button>
  </div>

  <div id="loginForm">
    <input id="chatIdInput" placeholder="Enter Order ID" />
    <select id="userTypeSelect">
      <option value="">Select your role</option>
      <option value="client">Client</option>
      <option value="player">Player</option>
      <option value="admin">Admin</option>
    </select>
    <input id="passwordInput" type="password" placeholder="Password" style="display:none;" />
    <button id="btnEnter">Enter Chat</button>
  </div>

  <ul id="chat"></ul>

  <form id="chatForm">
    <input id="msg" placeholder="Type your message..." />
    <button type="submit">Send</button>
  </form>

<script src="/socket.io/socket.io.js"></script>
<script>
/* === TU JS ORIGINAL, INTACTO === */
const socket = io({ transports: ['websocket','polling'] });

const chatCounter = document.getElementById('chatCounter');

let chatId=null;
let counter=0;

/* === CONTADOR POR CHAT === */
function loadCounter(){
  counter = parseInt(localStorage.getItem('ufs_counter_'+chatId)) || 0;
  chatCounter.textContent = 'Messages: ' + counter;
}

function incrementCounter(){
  counter++;
  localStorage.setItem('ufs_counter_'+chatId, counter);
  chatCounter.textContent = 'Messages: ' + counter;
}

/* === SOLO SE MUESTRA AL ENTRAR AL CHAT === */
function showCounter(){
  chatCounter.style.display='block';
}

function hideCounter(){
  chatCounter.style.display='none';
}

/* === ENGANCHE SEGURO AL CHAT === */
socket.on('joined', ()=>{
  loadCounter();
  showCounter();
});

/* === SOLO CUENTA MENSAJES NUEVOS === */
socket.on('receiveMessage', ()=>{
  incrementCounter();
});
</script>

</body>
</html>
